@startuml

entity "Roles" as roles {
    +id : INT
    name : VARCHAR(50)
    description : TEXT
    level : INT
}

entity "Users" as users {
    +id : INT
    username : VARCHAR(20)
    password : VARCHAR(100)
    mail : VARCHAR(100)
    foto_profilo : VARCHAR(255)
    birthday : DATE
    bio : TEXT
    status : VARCHAR(20)
    registration_status : VARCHAR(20)
    created_at : TIMESTAMP
}

entity "Follows" as follows {
    +follower_id : INT
    +followed_id : INT
}

entity "Media" as media {
    +id : INT
    type : VARCHAR(20)
    title : VARCHAR(255)
    year : INT
    description : TEXT
    link : VARCHAR(255)
    created_at : TIMESTAMP
}

entity "Songs" as songs {
    +id : INT
    duration : INT
    recording_date : DATE
    location : VARCHAR(100)
    additional_info : TEXT
    is_author : BOOLEAN
    is_performer : BOOLEAN
}

entity "Documents" as documents {
    +id : INT
    format : VARCHAR(20)
    pages : INT
    caption : TEXT
}

entity "Videos" as videos {
    +id : INT
    duration : INT
    location : VARCHAR(100)
    additional_info : TEXT
    director : VARCHAR(100)
}

entity "Genres" as genres {
    +id : INT
    name : VARCHAR(50)
}

entity "Song_Genres" as song_genres {
    +song_id : INT
    +genre_id : INT
}

entity "Authors" as authors {
    +id : INT
    name : VARCHAR(100)
}

entity "Song_Authors" as song_authors {
    +song_id : INT
    +author_id : INT
}

entity "Instruments" as instruments {
    +id : INT
    name : VARCHAR(100)
}

entity "Performers" as performers {
    +id : INT
    name : VARCHAR(100)
}

entity "Song_Performances" as song_performances {
    +song_id : INT
    +performer_id : INT
    +instrument_id : INT
}

entity "Files" as files {
    +id : INT
    +media_id : INT
    file_id : VARCHAR(255)
}

entity "Notes" as notes {
    +id : INT
    song_id : INT
    x_coord : NUMERIC(6,2)
    y_coord : NUMERIC(6,2)
    start_time : NUMERIC(6,2)
    end_time : NUMERIC(6,2)
    solos : TEXT
    rhythm : VARCHAR(50)
    link : VARCHAR(255)
    comment : TEXT
}

entity "Note_Performers_Instruments" as note_performers_instruments {
    +note_id : INT
    +performer_id : INT
    +instrument_id : INT
}

entity "Comments" as comments {
    +id : INT
    +user_id : INT
    +media_id : INT
    +note_id : INT
    +parent_comment_id : INT
    text : TEXT
    like_count : INT
    dislike_count : INT
}

entity "Concerts" as concerts {
    +id : INT
    video_id : INT
    title : VARCHAR(255)
    description : TEXT
    created_at : TIMESTAMP
}

entity "Concert_Segments" as concert_segments {
    +id : INT
    concert_id : INT
    song_id : INT
    start_time : NUMERIC(6,2)
    end_time : NUMERIC(6,2)
    performers : TEXT
    instruments : TEXT
    comment : TEXT
}

' Relationships
roles -- users : "has"
users -- follows : "follows"
users -- comments : "writes"
users -- notes : "creates"
media -- songs : "contains"
media -- documents : "contains"
media -- videos : "contains"
songs -- song_genres : "has"
songs -- song_authors : "has"
songs -- song_performances : "performed by"
songs -- notes : "contains"
songs -- files : "has"
videos -- concerts : "records"
concerts -- concert_segments : "has"
concert_segments -- song_performances : "features"
concert_segments -- notes : "contains"

song_genres -- genres : "belongs to"
song_authors -- authors : "written by"
song_performances -- performers : "performed by"
song_performances -- instruments : "played with"
note_performers_instruments -- performers : "associated with"
note_performers_instruments -- instruments : "associated with"

@enduml
